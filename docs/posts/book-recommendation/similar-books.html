<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-0.9.315">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2021-02-15">
<meta name="description" content="Using Collaborative Filtering to recommend books.">

<title>Jimmie Munyi - Making a Book Recommendation System</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link class="quarto-color-scheme" id="quarto-text-highlighting-styles" href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet">
<link class="quarto-color-scheme quarto-color-alternate" rel="prefetch" id="quarto-text-highlighting-styles" href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link class="quarto-color-scheme" href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet">
<link class="quarto-color-scheme quarto-color-alternate" rel="prefetch" href="../../site_libs/bootstrap/bootstrap-dark.min.css">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="../../styles.css">
<meta name="twitter:title" content="Jimmie Munyi - Making a Book Recommendation System">
<meta name="twitter:description" content="Using Collaborative Filtering to recommend books.">
<meta name="twitter:card" content="summary">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Jimmie Munyi</span>
  </a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../projects.html">Projects</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html">About Me</a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/jimmiemunyi"><i class="bi bi-github" role="img">
</i> 
 </a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/jimmie_munyi"><i class="bi bi-twitter" role="img">
</i> 
 </a>
  </li>  
</ul>
              <div class="quarto-toggle-container">
                  <a href="" class="quarto-color-scheme-toggle nav-link" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
                  <a href="" class="quarto-reader-toggle nav-link" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
              </div>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#imports" id="toc-imports" class="nav-link active" data-scroll-target="#imports">Imports</a></li>
  <li><a href="#introduction" id="toc-introduction" class="nav-link" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#the-dataset" id="toc-the-dataset" class="nav-link" data-scroll-target="#the-dataset">The DataSet</a></li>
  <li><a href="#subset-of-the-dataset" id="toc-subset-of-the-dataset" class="nav-link" data-scroll-target="#subset-of-the-dataset">Subset of the Dataset</a>
  <ul class="collapse">
  <li><a href="#creating-the-dataloaders" id="toc-creating-the-dataloaders" class="nav-link" data-scroll-target="#creating-the-dataloaders">Creating the DataLoaders</a></li>
  <li><a href="#creating-the-model" id="toc-creating-the-model" class="nav-link" data-scroll-target="#creating-the-model">Creating the Model</a></li>
  <li><a href="#interpreting-the-embeddings" id="toc-interpreting-the-embeddings" class="nav-link" data-scroll-target="#interpreting-the-embeddings">Interpreting the Embeddings</a></li>
  <li><a href="#neural-network" id="toc-neural-network" class="nav-link" data-scroll-target="#neural-network">Neural Network</a></li>
  </ul></li>
  <li><a href="#use-full-dataset" id="toc-use-full-dataset" class="nav-link" data-scroll-target="#use-full-dataset">Use Full DataSet</a></li>
  <li><a href="#interpreting-the-full-model" id="toc-interpreting-the-full-model" class="nav-link" data-scroll-target="#interpreting-the-full-model">Interpreting the Full Model</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Making a Book Recommendation System</h1>
  <div class="quarto-categories">
    <div class="quarto-category">technical</div>
    <div class="quarto-category">intermediate</div>
    <div class="quarto-category">collaborative-filtering</div>
  </div>
  </div>

<div>
  <div class="description">
    Using Collaborative Filtering to recommend books.
  </div>
</div>




<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">February 15, 2021</p>
    </div>
  </div>
    
  </div>
  

</header>

<p>Turning this into an app that people can interact with:</p>
<div id="fig-anonymous-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><a href="https://share.streamlit.io/jimmiemunyi/similarbooks/main/similar_books.py"><img src="https://static.streamlit.io/badges/streamlit_badge_black_white.svg" class="img-fluid figure-img"></a></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Streamlit</figcaption><p></p>
</figure>
</div>
<section id="imports" class="level1">
<h1>Imports</h1>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> fastai.collab <span class="im">import</span> <span class="op">*</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> fastai.tabular.<span class="bu">all</span> <span class="im">import</span> <span class="op">*</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>We are going to use <a href="https://en.wikipedia.org/wiki/Collaborative_filtering">Collaborative Filtering</a> to create a book recommendation system. Recommender Systems based on collaborative make recommendations based on what similar users liked. So if I have read Inferno by Dan Brown and liked it (which I did), the system will look for books also liked by people who liked Inferno and recommend them to me.</p>
<p>It uses a concept called <em>latent factors</em>. What are latent factors you may ask? Let us understand them using an example.</p>
<p>Let us take two books. Inferno by Dan Brown and To Kill A MockingBird by Harper Lee. Those are two very different books. Let us consider three aspects to classify this books: classics (whether the book is a classic or not), action-oriented and new-gen (modern-times setting).</p>
<p>We will give a score ranging from 1 to -1 to all these three aspects of our books, 1 meaning it scores high on that aspect and -1 for a low score.</p>
<p>So, for example, To Kill a MockingBird is a classic, it is not so much action-oriented and also not so much new-gen. So its scores would look as follows:</p>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>mocking_bird <span class="op">=</span> np.array([<span class="fl">0.9</span>, <span class="op">-</span><span class="fl">0.85</span>, <span class="op">-</span><span class="fl">0.9</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>For Inferno, which is not so much a classic, is action-oriented and is new-gen, we would have the following representation:</p>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>inferno <span class="op">=</span> np.array([<span class="op">-</span><span class="fl">0.9</span>, <span class="fl">0.7</span>, <span class="fl">0.9</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now, let us hypothesize a reader who doesn’t enjoy classics that much, doesn’t mind action books and really prefers new-gen books (this user actually represents my liking).</p>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>reader <span class="op">=</span> np.array([<span class="op">-</span><span class="fl">0.5</span>, <span class="fl">0.2</span>, <span class="fl">0.9</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>To see which book we need to recommend our not-so-much hypothetical reader, we will need to perform dot product between the book factors and the user factors. Dot product simply means multiply each consecutive items and add the results.</p>
<div class="cell" data-outputid="9373daef-8f29-43e2-a2c5-f25bbec13fdd" data-execution_count="7">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>(reader<span class="op">*</span>mocking_bird).<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<pre><code>-1.4300000000000002</code></pre>
</div>
</div>
<div class="cell" data-outputid="20fa502e-28f1-4a0f-881b-e97a8b588278" data-execution_count="8">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>(reader<span class="op">*</span>inferno).<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<pre><code>1.4</code></pre>
</div>
</div>
<p>Based on the results, we would want to recommend Inferno to our user and not To Kill A MockingBird since he wouldn’t enjoy the latter that much.</p>
<p>The magic part about Collaborative Filtering and the reason we called our factors <em>latent</em> is that; we never tell our model anything about what factors to consider or how high or low a book or user scores on each factors. The model learns all that by itself. We simply feed it books rated by users and using that information, it figures out a way to score each factor. As I said, pretty magical.</p>
<p>Let us see that in action.</p>
</section>
<section id="the-dataset" class="level1">
<h1>The DataSet</h1>
<p>Luckily, there is already a good dataset on books and ratings by users called GoodBooks10k available from <a href="https://github.com/zygmuntz/goodbooks-10k">this repo in github</a>. As the name suggests, it contains ratings of 10,000 books and 6 million ratings.</p>
<p>We can download and extract the data using the following convinient functions:</p>
<div class="cell" data-outputid="bd326c2a-d940-4ddb-e60b-9c74da6a8aad" data-execution_count="9">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>path <span class="op">=</span> Path(<span class="st">'data'</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="kw">not</span> path.exists():</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  path.mkdir()</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  untar_data(<span class="st">'https://github.com/zygmuntz/goodbooks-10k/releases/download/v1.0/goodbooks-10k.zip'</span>, dest<span class="op">=</span>path)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

</div>
</div>
<p>We can inspect what has been downloaded:</p>
<div class="cell" data-outputid="3206c83d-8f6b-4b18-9aec-139eecd76a29" data-execution_count="11">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>path.ls(file_type<span class="op">=</span><span class="st">'text'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">
<pre><code>(#5) [Path('README.md'),Path('tags.csv'),Path('books.csv'),Path('book_tags.csv'),Path('ratings.csv')]</code></pre>
</div>
</div>
<p>We are interested in the rating.csv file, since that is where the actual ratings are. We can load it up in a pandas dataframe:</p>
<div class="cell" data-outputid="cf572ec1-3a33-4857-b77e-25aab30fc8de" data-execution_count="12">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>ratings <span class="op">=</span> pd.read_csv(path<span class="op">/</span><span class="st">'ratings.csv'</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>ratings</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>user_id</th>
      <th>book_id</th>
      <th>rating</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>258</td>
      <td>5</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>4081</td>
      <td>4</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>260</td>
      <td>5</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2</td>
      <td>9296</td>
      <td>5</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2</td>
      <td>2318</td>
      <td>3</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>5976474</th>
      <td>49925</td>
      <td>510</td>
      <td>5</td>
    </tr>
    <tr>
      <th>5976475</th>
      <td>49925</td>
      <td>528</td>
      <td>4</td>
    </tr>
    <tr>
      <th>5976476</th>
      <td>49925</td>
      <td>722</td>
      <td>4</td>
    </tr>
    <tr>
      <th>5976477</th>
      <td>49925</td>
      <td>949</td>
      <td>5</td>
    </tr>
    <tr>
      <th>5976478</th>
      <td>49925</td>
      <td>1023</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
<p>5976479 rows × 3 columns</p>
</div>
</div>
</div>
<p>We have a <code>user_id</code> column that represents each user, <code>book_id</code> to represent the books and the <code>rating</code> column is the rating given to a book by a particular user. It ranges from 0 to 5.</p>
</section>
<section id="subset-of-the-dataset" class="level1">
<h1>Subset of the Dataset</h1>
<p>We don’t want to work on the full dataset right away since it would take a long time to model and this would limit the number of experiments we can carry out.</p>
<p>Instead, first we will work with only the first 100, 000 ratings.</p>
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>ratings <span class="op">=</span> ratings.iloc[:<span class="dv">100000</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We check for any missing value and drop them if they exists:</p>
<div class="cell" data-outputid="5e9afeb7-c3d7-4859-d176-21e3b7c9e2d0" data-execution_count="14">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>ratings.isnull().values.<span class="bu">any</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<pre><code>False</code></pre>
</div>
</div>
<p>Another issue is with the <code>book_id</code>. The model as is would work even if we used <code>book_id</code> but for visual purposes, we’d rather have the book title to look at, since that is more informative to us (not the model).</p>
<p>So we will have to load in the books.csv file and merge it with our ratings DataFrame.</p>
<div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>books <span class="op">=</span> pd.read_csv(path<span class="op">/</span><span class="st">'books.csv'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-outputid="3b47b475-dd1b-4310-8f0e-f7a3cb454bcf" data-execution_count="16">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>books.columns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="16">
<pre><code>Index(['book_id', 'goodreads_book_id', 'best_book_id', 'work_id',
       'books_count', 'isbn', 'isbn13', 'authors', 'original_publication_year',
       'original_title', 'title', 'language_code', 'average_rating',
       'ratings_count', 'work_ratings_count', 'work_text_reviews_count',
       'ratings_1', 'ratings_2', 'ratings_3', 'ratings_4', 'ratings_5',
       'image_url', 'small_image_url'],
      dtype='object')</code></pre>
</div>
</div>
<p>We drop some columns which we don’t require:</p>
<div class="cell" data-outputid="238f7b06-e675-42d5-a49e-f28159d03f58" data-execution_count="17">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>books.drop([<span class="st">'best_book_id'</span>, <span class="st">'work_id'</span>, <span class="st">'title'</span>,<span class="st">'books_count'</span>, <span class="st">'language_code'</span>, </span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>            <span class="st">'isbn13'</span>, <span class="st">'isbn'</span>,<span class="st">'ratings_count'</span>, <span class="st">'work_ratings_count'</span>, </span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>            <span class="st">'work_text_reviews_count'</span>, <span class="st">'ratings_1'</span>, <span class="st">'ratings_2'</span>, <span class="st">'ratings_3'</span>, </span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>            <span class="st">'ratings_4'</span>, <span class="st">'ratings_5'</span>,<span class="st">'image_url'</span>, <span class="st">'small_image_url'</span>], </span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>           axis<span class="op">=</span><span class="dv">1</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>books.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="17">
<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>book_id</th>
      <th>goodreads_book_id</th>
      <th>authors</th>
      <th>original_publication_year</th>
      <th>original_title</th>
      <th>average_rating</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>2767052</td>
      <td>Suzanne Collins</td>
      <td>2008.0</td>
      <td>The Hunger Games</td>
      <td>4.34</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>3</td>
      <td>J.K. Rowling, Mary GrandPré</td>
      <td>1997.0</td>
      <td>Harry Potter and the Philosopher's Stone</td>
      <td>4.44</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>41865</td>
      <td>Stephenie Meyer</td>
      <td>2005.0</td>
      <td>Twilight</td>
      <td>3.57</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>2657</td>
      <td>Harper Lee</td>
      <td>1960.0</td>
      <td>To Kill a Mockingbird</td>
      <td>4.25</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>4671</td>
      <td>F. Scott Fitzgerald</td>
      <td>1925.0</td>
      <td>The Great Gatsby</td>
      <td>3.89</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>Drop any missing values:</p>
<div class="cell" data-outputid="0f71bdf9-94f5-42ac-a67c-e2f557f54edc" data-execution_count="18">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>books.isnull().values.<span class="bu">any</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="18">
<pre><code>True</code></pre>
</div>
</div>
<div class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>books.dropna(inplace<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>And finally merge it to one DataFrame:</p>
<div class="cell" data-outputid="410c5861-6401-43cf-a232-55f399957b4d" data-execution_count="20">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>ratings <span class="op">=</span> ratings.merge(books)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>ratings.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="20">
<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>user_id</th>
      <th>book_id</th>
      <th>rating</th>
      <th>goodreads_book_id</th>
      <th>authors</th>
      <th>original_publication_year</th>
      <th>original_title</th>
      <th>average_rating</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>258</td>
      <td>5</td>
      <td>1232</td>
      <td>Carlos Ruiz Zafón, Lucia Graves</td>
      <td>2001.0</td>
      <td>La sombra del viento</td>
      <td>4.24</td>
    </tr>
    <tr>
      <th>1</th>
      <td>11</td>
      <td>258</td>
      <td>3</td>
      <td>1232</td>
      <td>Carlos Ruiz Zafón, Lucia Graves</td>
      <td>2001.0</td>
      <td>La sombra del viento</td>
      <td>4.24</td>
    </tr>
    <tr>
      <th>2</th>
      <td>143</td>
      <td>258</td>
      <td>4</td>
      <td>1232</td>
      <td>Carlos Ruiz Zafón, Lucia Graves</td>
      <td>2001.0</td>
      <td>La sombra del viento</td>
      <td>4.24</td>
    </tr>
    <tr>
      <th>3</th>
      <td>242</td>
      <td>258</td>
      <td>5</td>
      <td>1232</td>
      <td>Carlos Ruiz Zafón, Lucia Graves</td>
      <td>2001.0</td>
      <td>La sombra del viento</td>
      <td>4.24</td>
    </tr>
    <tr>
      <th>4</th>
      <td>325</td>
      <td>258</td>
      <td>4</td>
      <td>1232</td>
      <td>Carlos Ruiz Zafón, Lucia Graves</td>
      <td>2001.0</td>
      <td>La sombra del viento</td>
      <td>4.24</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<section id="creating-the-dataloaders" class="level2">
<h2 class="anchored" data-anchor-id="creating-the-dataloaders">Creating the DataLoaders</h2>
<p>Since that looks okay, we can go ahead and create our <code>DataLoaders</code> object that we will feed to the model. A <code>DataLoaders</code> is simply a convinient object that holds our training and validation data and will pass in the data to our model in mini-batches.</p>
<p>We can look up the documentation of a function by calling the <code>doc</code> function.</p>
<div class="cell" data-outputid="872558d9-09da-4d58-df57-bdd4c3d2e517" data-execution_count="21">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>doc(CollabDataLoaders.from_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<h4 id="CollabDataLoaders.from_df" class="doc_header anchored"><code>CollabDataLoaders.from_df</code><a href="https://github.com/fastai/fastai/tree/master/fastai/collab.py#L16" class="source_link" style="float:right">[source]</a></h4><blockquote class="blockquote"><p><code>CollabDataLoaders.from_df</code>(<strong><code>ratings</code></strong>, <strong><code>valid_pct</code></strong>=<em><code>0.2</code></em>, <strong><code>user_name</code></strong>=<em><code>None</code></em>, <strong><code>item_name</code></strong>=<em><code>None</code></em>, <strong><code>rating_name</code></strong>=<em><code>None</code></em>, <strong><code>seed</code></strong>=<em><code>None</code></em>, <strong><code>path</code></strong>=<em><code>'.'</code></em>, <strong><code>bs</code></strong>=<em><code>64</code></em>, <strong><code>val_bs</code></strong>=<em><code>None</code></em>, <strong><code>shuffle_train</code></strong>=<em><code>True</code></em>, <strong><code>device</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Create a <code>DataLoaders</code> suitable for collaborative filtering from <code>ratings</code>.</p>
<p><a href="https://docs.fast.ai/collab#CollabDataLoaders.from_df" target="_blank" rel="noreferrer noopener">Show in docs</a></p>
</div>
</div>
<p>The above tells us what we will need to pass in the function in order to create our <code>DataLoaders</code>. Specifically we will need to pass in :</p>
<ul>
<li>The DataFrame we are creating from (ratings)</li>
<li>Size of the Validation split (20%)</li>
<li>The column that represents our user (user_id)</li>
<li>The column that represents our item (original_title)</li>
<li>The column that represents our rating (rating)</li>
</ul>
<div class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>dls <span class="op">=</span> CollabDataLoaders.from_df(ratings<span class="op">=</span>ratings, valid_pct<span class="op">=</span><span class="fl">0.2</span>, </span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>                                user_name<span class="op">=</span><span class="st">'user_id'</span>, item_name<span class="op">=</span><span class="st">'original_title'</span>,</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>                                rating_name<span class="op">=</span><span class="st">'rating'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can look at one batch of data:</p>
<div class="cell" data-outputid="477a52b0-cd45-4603-fb97-6a6b108376ac" data-execution_count="23">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>dls.show_batch()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>user_id</th>
      <th>original_title</th>
      <th>rating</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>791</td>
      <td>Sphere</td>
      <td>3</td>
    </tr>
    <tr>
      <th>1</th>
      <td>543</td>
      <td>Metamorphoses</td>
      <td>5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1835</td>
      <td>1491: New Revelations of the Americas Before Columbus</td>
      <td>4</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2688</td>
      <td>Good Omens: The Nice and Accurate Prophecies of Agnes Nutter, Witch</td>
      <td>5</td>
    </tr>
    <tr>
      <th>4</th>
      <td>264</td>
      <td>Jonathan Livingston Seagull</td>
      <td>5</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2074</td>
      <td>The Curious Incident of the Dog in the Night-Time</td>
      <td>4</td>
    </tr>
    <tr>
      <th>6</th>
      <td>2136</td>
      <td>The Lovely Bones</td>
      <td>4</td>
    </tr>
    <tr>
      <th>7</th>
      <td>1089</td>
      <td>Franny and Zooey</td>
      <td>5</td>
    </tr>
    <tr>
      <th>8</th>
      <td>2334</td>
      <td>Great Expectations</td>
      <td>4</td>
    </tr>
    <tr>
      <th>9</th>
      <td>750</td>
      <td>The History of the Hobbit, Part One: Mr. Baggins</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div>
</div>
<p>For the latent factors of both our books, we will initialize a random Embedding with a size of all the books we have and the number of factors we want. The same goes for the latent factors of our users.</p>
<p>The values in these Embeddings will be updated by BackPropagation until they become meaningful.</p>
<p>For our small subset of data, we will use 50 factors. This simply means we are giving our model an allowance to represent each books in 50 different ways (e.g.&nbsp;action, classics etc).</p>
<p>So, we first should get the number of users and the number of books:</p>
<div class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>n_books <span class="op">=</span> <span class="bu">len</span>(dls.classes[<span class="st">'original_title'</span>])</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>n_users <span class="op">=</span> <span class="bu">len</span>(dls.classes[<span class="st">'user_id'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>For learning purposes, we should also get into the habit of manually chekcking shapes of the data in our batches and see if we understand why it is so:</p>
<div class="cell" data-outputid="3e9afb58-f3e3-49d6-dfb4-470f6697c104" data-execution_count="25">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>xb, yb <span class="op">=</span> dls.one_batch()</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>xb.shape, yb.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="25">
<pre><code>(torch.Size([64, 2]), torch.Size([64, 1]))</code></pre>
</div>
</div>
<p>We are using a batch size of 64, so that makes sense. For our independent variable (X), we have two items there, which are the user and the book and for the dependent variable (y), we only have the rating of the book. That is why the above shapes are so.</p>
</section>
<section id="creating-the-model" class="level2">
<h2 class="anchored" data-anchor-id="creating-the-model">Creating the Model</h2>
<p>Next, we need to handle the model part.</p>
<div class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> CollabFiltering(Module):</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, n_users, n_books, n_factors, y_range<span class="op">=</span>(<span class="dv">0</span>, <span class="fl">5.5</span>)):</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>    <span class="va">self</span>.u_weights <span class="op">=</span> Embedding(n_users, n_factors)</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>    <span class="va">self</span>.u_bias <span class="op">=</span> Embedding(n_users, <span class="dv">1</span>)</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>    <span class="va">self</span>.i_weights <span class="op">=</span> Embedding(n_books, n_factors)</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>    <span class="va">self</span>.i_bias <span class="op">=</span> Embedding(n_books, <span class="dv">1</span>)</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>    <span class="va">self</span>.y_range <span class="op">=</span> y_range</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>  <span class="kw">def</span> forward(<span class="va">self</span>, x):</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>    users <span class="op">=</span> <span class="va">self</span>.u_weights(x[:,<span class="dv">0</span>])</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>    books <span class="op">=</span> <span class="va">self</span>.i_weights(x[:,<span class="dv">1</span>])</span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>    res <span class="op">=</span> (users <span class="op">*</span> books).<span class="bu">sum</span>(dim<span class="op">=</span><span class="dv">1</span>, keepdims<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>    res <span class="op">+=</span> <span class="va">self</span>.u_bias(x[:,<span class="dv">0</span>]) <span class="op">+</span> <span class="va">self</span>.i_bias(x[:,<span class="dv">1</span>])</span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>    res <span class="op">=</span> sigmoid_range(res, <span class="op">*</span><span class="va">self</span>.y_range)</span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> res</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Our Model Inherits from <code>Module</code> which is what PyTorch expects:</p>
<pre><code>class CollabFiltering(Module):</code></pre>
<p>The model takes in the number of users, the number of books, the number of factors we want to use for modelling and a y_range that defaults to a tuple of (0, 5.5).</p>
<p>The purpose of the y_range is to squish our output between 0 and 5. (We choose 5.5 as the upper limit since we are going to be using sigmoid range to contain our output. And since values in sigmoid never reach the upper limit, to predict a value of 5, we are going to need to go higher).</p>
<p>It then creates the Embeddings of the users and the books. We are also going to create biases for each user and each book to capture the fact that some users generally more positive or negative in their recommendations than others and smoe books are just plain better or worse than others.</p>
<pre><code>def __init__(self, n_users, n_books, n_factors, y_range=(0, 5.5)):
    self.u_weights = Embedding(n_users, n_factors)
    self.u_bias = Embedding(n_users, 1)
    self.i_weights = Embedding(n_books, n_factors)
    self.i_bias = Embedding(n_books, 1)
    self.y_range = y_range</code></pre>
<p>The forward method simply gets the factors from the user embedding and book embedding, performs dot product on them, adds the biases then uses sigmoid range to squish the output between 0 and 5 and returns the result.</p>
<pre><code>def forward(self, x):
    users = self.u_weights(x[:,0])
    books = self.i_weights(x[:,1])
    res = (users * books).sum(dim=1, keepdims=True)
    res += self.u_bias(x[:,0]) + self.i_bias(x[:,1])
    res = sigmoid_range(res, *self.y_range)
    return res</code></pre>
<p>We can now instantiate the model with 50 factors and create our Learner. We are going to use Mean Squared Error as our loss function since this is a regression problem.</p>
<div class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> CollabFiltering(n_users, n_books, <span class="dv">50</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>learn <span class="op">=</span> Learner(dls, model, loss_func<span class="op">=</span>MSELossFlat())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let us find a suitable Learning rate and train the model for 6 epochs. We use a weight decay of 0.2 to regularize our model</p>
<div class="cell" data-outputid="4c307f11-dce9-4116-8c8c-4c72fec2a75a" data-execution_count="29">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>learn.lr_find()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display" data-execution_count="29">
<pre><code>SuggestedLRs(lr_min=0.03019951581954956, lr_steep=7.585775892948732e-05)</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="similar-books_files/figure-html/cell-30-output-3.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-outputid="a6299b1a-8a0e-41ed-e6f6-31b901631ff5" data-execution_count="30">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>learn.fit_one_cycle(<span class="dv">6</span>, <span class="fl">1e-2</span>, wd<span class="op">=</span><span class="fl">0.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>0.972651</td>
      <td>0.988126</td>
      <td>00:08</td>
    </tr>
    <tr>
      <td>1</td>
      <td>0.959149</td>
      <td>0.947992</td>
      <td>00:08</td>
    </tr>
    <tr>
      <td>2</td>
      <td>0.908314</td>
      <td>0.913695</td>
      <td>00:08</td>
    </tr>
    <tr>
      <td>3</td>
      <td>0.789891</td>
      <td>0.863736</td>
      <td>00:08</td>
    </tr>
    <tr>
      <td>4</td>
      <td>0.646984</td>
      <td>0.828928</td>
      <td>00:08</td>
    </tr>
    <tr>
      <td>5</td>
      <td>0.538308</td>
      <td>0.826404</td>
      <td>00:08</td>
    </tr>
  </tbody>
</table>
</div>
</div>
<p>We get a final MSE of 0.826404 which is actually pretty good for out task at hand.</p>
</section>
<section id="interpreting-the-embeddings" class="level2">
<h2 class="anchored" data-anchor-id="interpreting-the-embeddings">Interpreting the Embeddings</h2>
<p>Let us start by interpretting the book biases. We could have easily ranked the books by the ratings and checked the last five items but bias tells us something more interesting. These books are books that, even if a user was well matched to the latent factors of the book (e.g action, comedy etc), they still didn’t like the books and that is why the books have a low bias. In short, they are generally bad books.</p>
<p>These are the 5 books with the lowest bias from our model.</p>
<div class="cell" data-outputid="406be2f9-ee53-4fe4-f119-0557a22a5cd1" data-execution_count="31">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>book_bias <span class="op">=</span> learn.model.i_bias.weight.squeeze()</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>idxs <span class="op">=</span> book_bias.argsort()[:<span class="dv">5</span>]</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>[dls.classes[<span class="st">'original_title'</span>][i] <span class="cf">for</span> i <span class="kw">in</span> idxs]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="31">
<pre><code>['Trading Up',
 'One Night @ The Call Center',
 'Four Blondes',
 'Lost',
 'Eat That Frog!: 21 Great Ways to Stop Procrastinating and Get More Done in Less Time']</code></pre>
</div>
</div>
<p>Since our rating DataFrame included the GoodReads ID of each book, we can create a URL of a single book and check out the reviews from GoodReads.</p>
<p>Let’s use Four Blondes as an example. We can locate its entry in our DataFrame using the following code:</p>
<div class="cell" data-outputid="3f9493a2-708a-4464-f7b6-b89fd1337823" data-execution_count="32">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>books.loc[books[<span class="st">'original_title'</span>]<span class="op">==</span><span class="st">'Four Blondes'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="32">
<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>book_id</th>
      <th>goodreads_book_id</th>
      <th>authors</th>
      <th>original_publication_year</th>
      <th>original_title</th>
      <th>average_rating</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>4008</th>
      <td>4009</td>
      <td>6613</td>
      <td>Candace Bushnell</td>
      <td>2000.0</td>
      <td>Four Blondes</td>
      <td>2.8</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>Then using its <code>goodreads_id</code>, create a URL that we can follow to read its reviews:</p>
<div class="cell" data-outputid="3c4f2355-5e28-4264-fecf-446ed31a853e" data-execution_count="33">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="bu">id</span> <span class="op">=</span> <span class="dv">6613</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>url <span class="op">=</span> <span class="ss">f'https://www.goodreads.com/book/show/</span><span class="sc">{</span><span class="bu">id</span><span class="sc">}</span><span class="ss">'</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>url</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="33">
<pre><code>'https://www.goodreads.com/book/show/6613'</code></pre>
</div>
</div>
<p>I haven’t read the book myself but I don’t think I will too. Reading the reviews from GoodReads looks like people didn’t really enjoy this book. Here is one extract of the reviews:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="four_blondes.png" class="img-fluid figure-img"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Four Blondes Sample Review</figcaption><p></p>
</figure>
</div>
<p>Now let us do the opposite, and check for the books with the highest book bias. This means that these are generally good books and even if you don’t enjoy such genres, there is a high chance you will enjoy this books:</p>
<div class="cell" data-outputid="b61af801-2220-48d4-92a2-b0806a78bbf1" data-execution_count="34">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>idxs <span class="op">=</span> book_bias.argsort(descending<span class="op">=</span><span class="va">True</span>)[:<span class="dv">5</span>]</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>[dls.classes[<span class="st">'original_title'</span>][i] <span class="cf">for</span> i <span class="kw">in</span> idxs]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="34">
<pre><code>['Harry Potter and the Deathly Hallows',
 'A Thousand Splendid Suns',
 'Where the Wild Things Are',
 'Le Petit Prince',
 'دیوان\u200e\u200e [Dīvān]']</code></pre>
</div>
</div>
<p>At the very top is a book I enjoyed very much myself: Harry Potter and the Deathly Hallows. Since I may be biased towards that book, let us check for reviews of a book I haven’t read myself.</p>
<div class="cell" data-outputid="b6aa16dc-b7b5-4f21-e7f7-4ce47f5caadc" data-execution_count="35">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="bu">id</span> <span class="op">=</span> <span class="bu">int</span>(books.loc[books[<span class="st">'original_title'</span>]<span class="op">==</span><span class="st">'Le Petit Prince'</span>][<span class="st">'goodreads_book_id'</span>].values)</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>url <span class="op">=</span> <span class="ss">f'https://www.goodreads.com/book/show/</span><span class="sc">{</span><span class="bu">id</span><span class="sc">}</span><span class="ss">'</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>url</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="35">
<pre><code>'https://www.goodreads.com/book/show/157993'</code></pre>
</div>
</div>
<p>I was suprised to find that ‘Le Petit Prince’ or ‘The Little Prince’ was a child-like novel which adults enjoy as well. Here is one review from GoodReads:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="little_prince.png" class="img-fluid figure-img"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Little Prince Sample Review</figcaption><p></p>
</figure>
</div>
<p>It is definitely on my to-read list now.</p>
<p>Next, let us try and intepret the Book Embedding Factors. Remember, we had 50 factors in our model. Well, intepreting a 50-dimensional Embedding turns out to be a difficult task for us human beings.</p>
<p>Luckily we have a method called <code>PCA</code> which stands for Principal Component Analysis that can be used to reduce the dimensions to something that can be plotted in a graph.</p>
<p>Here is the outcome:</p>
<div class="cell" data-outputid="6ef336d6-93d8-41f6-931d-d056aa62e11b" data-execution_count="36">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>r <span class="op">=</span> np.arange(<span class="dv">0</span>, <span class="dv">2</span>, <span class="fl">0.01</span>)</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>theta <span class="op">=</span> <span class="dv">2</span> <span class="op">*</span> np.pi <span class="op">*</span> r</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>  subplot_kw <span class="op">=</span> {<span class="st">'projection'</span>: <span class="st">'polar'</span>} </span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>ax.plot(theta, r)</span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>ax.set_rticks([<span class="fl">0.5</span>, <span class="dv">1</span>, <span class="fl">1.5</span>, <span class="dv">2</span>])</span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>ax.grid(<span class="va">True</span>)</span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>g = ratings.groupby(‘original_title’)[‘rating’].count() top_books = g.sort_values(ascending=False).index.values[:10000] top_idxs = tensor([learn.dls.classes[‘original_title’].o2i[m] for m in top_books]) books_w = learn.model.i_weights.weight[top_idxs].cpu().detach() books_pca = books_w.pca(3) fac0,fac1,fac2 = books_pca.t() idxs = list(range(50)) X = fac0[idxs] Y = fac2[idxs] plt.figure(figsize=(12,12)) plt.scatter(X, Y) for i, x, y in zip(top_books[idxs], X, Y): plt.text(x,y,i, color=np.random.rand(3)*0.7, fontsize=11) plt.show()</p>
<pre><code>
::: {.cell-output .cell-output-display}
![](similar-books_files/figure-html/cell-37-output-1.png){}
:::
:::


As you can see, our model has learned for itself to seperate the books into different categories. If you look at the very top, we have the classic books, the likes of *To Kill A MockingBird* and *The Great Gatsby*. At the right side we have the likes of *The Da Vinci Code* and *Angels and Demons* which are more of Mystery Thriller Novels and are more of reality fiction novels. At the bottom we have *The Hobit* books which are more of fantasy novels and Mythology.

What is magical is our model learned all of these on its own! We never explicitely told it what genres a particular book belongs to. We only fed it user ratings and it learned all about them itself.

## Generating Book Reviews

Now comes the interesting part. How to generate a book review for a user. It is actually a very simple concept. The intuition is two similar books should have a smaller distance between them (of the Embeddings) than two different books. So, we will require a reader to input the name of a book he or she enjoyed reading and we will generate a recommendation of books for them.

Let us experiment with 'The Da Vinci Code' by Dan Brown and see the 5 most similar books to it using our model:

::: {.cell outputId='e9a24ee4-7dcb-497d-8327-c63233f3f649' execution_count=37}
``` {.python .cell-code}
book_factors = learn.model.i_weights.weight
idx = dls.classes['original_title'].o2i['The Da Vinci Code']
distances = nn.CosineSimilarity(dim=1)(book_factors, book_factors[idx][None])
idx = distances.argsort(descending=True)[1:6]
[dls.classes['original_title'][i] for i in idx]</code></pre>
<div class="cell-output cell-output-display" data-execution_count="37">
<pre><code>['The Sweet Far Thing',
 'Angels &amp; Demons ',
 'Back Roads',
 "What to Expect When You're Expecting",
 'What to Expect the First Year']</code></pre>
</div>
</div>
<p>According to our model, The Sweet Far Thing is the most similar book, so let us generate a URL and see the reviews:</p>
<div class="cell" data-outputid="1c017cdd-3394-4b1b-dc86-798fef083980" data-execution_count="38">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="bu">id</span> <span class="op">=</span> <span class="bu">int</span>(books.loc[books[<span class="st">'original_title'</span>]<span class="op">==</span><span class="st">'The Sweet Far Thing'</span>][<span class="st">'goodreads_book_id'</span>].values)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>url <span class="op">=</span> <span class="ss">f'https://www.goodreads.com/book/show/</span><span class="sc">{</span><span class="bu">id</span><span class="sc">}</span><span class="ss">'</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>url</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="38">
<pre><code>'https://www.goodreads.com/book/show/127459'</code></pre>
</div>
</div>
<p>The book description describes it as a Thriller novel which was the same case with The Da Vinci Code.</p>
</section>
<section id="neural-network" class="level2">
<h2 class="anchored" data-anchor-id="neural-network">Neural Network</h2>
<p>Now, we will experiment with a Neural Network Model and see if it performs better than our Dot Product Model.</p>
<p>To turn our Model into a Deep Learning Model, we need to concatenate the Embeddings together and pass them through linear layers with non-linearities between them. Our Neural network will have 100 neurons and utilize a ReLU between them. Here is the code:</p>
<div class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> CollabFilteringNN(Module):</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, user_sz, book_sz, y_range<span class="op">=</span>(<span class="dv">0</span>, <span class="fl">5.5</span>), n_act<span class="op">=</span><span class="dv">100</span>):</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>    <span class="va">self</span>.user_factors <span class="op">=</span> Embedding(<span class="op">*</span>user_sz)</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>    <span class="va">self</span>.book_factors <span class="op">=</span> Embedding(<span class="op">*</span>book_sz)</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>    <span class="va">self</span>.layers <span class="op">=</span> nn.Sequential(</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>        nn.Linear(user_sz[<span class="dv">1</span>]<span class="op">+</span>book_sz[<span class="dv">1</span>], n_act),</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>        nn.ReLU(),</span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>        nn.Linear(n_act, <span class="dv">1</span>)</span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>    <span class="va">self</span>.y_range <span class="op">=</span> y_range</span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a>  <span class="kw">def</span> forward(<span class="va">self</span>, x):</span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a>    embs <span class="op">=</span> <span class="va">self</span>.user_factors(x[:,<span class="dv">0</span>]), <span class="va">self</span>.book_factors(x[:,<span class="dv">1</span>])</span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> <span class="va">self</span>.layers(torch.cat(embs, dim<span class="op">=</span><span class="dv">1</span>))</span>
<span id="cb53-17"><a href="#cb53-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sigmoid_range(x, <span class="op">*</span><span class="va">self</span>.y_range)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We then instantiate the neural network. We will use the <code>get_emb_sz</code> to get good Embedding sizes for our users and books. Remember since we will concatenate the Embeddings and not multiply them, they can now have different sizes.</p>
<div class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>nn_model <span class="op">=</span> CollabFilteringNN(<span class="op">*</span>get_emb_sz(dls))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can check out our model:</p>
<div class="cell" data-outputid="2ea415c8-d1b4-4772-9fec-528bc5b5c86f" data-execution_count="41">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>nn_model</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="41">
<pre><code>CollabFilteringNN(
  (user_factors): Embedding(1795, 106)
  (book_factors): Embedding(4879, 186)
  (layers): Sequential(
    (0): Linear(in_features=292, out_features=100, bias=True)
    (1): ReLU()
    (2): Linear(in_features=100, out_features=1, bias=True)
  )
)</code></pre>
</div>
</div>
<p>We will now create our Learner with the same <code>MSE</code> loss function, find a suitable learning rate and fit our model for 5 epochs using a regularization weight decay of 0.05:</p>
<div class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>learn <span class="op">=</span> Learner(dls, nn_model, loss_func<span class="op">=</span>MSELossFlat())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-outputid="496d39e3-64d3-47d2-d7e4-2df181c5c204" data-execution_count="43">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>learn.lr_find()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display" data-execution_count="43">
<pre><code>SuggestedLRs(lr_min=0.006918309628963471, lr_steep=3.311311274956097e-06)</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="similar-books_files/figure-html/cell-44-output-3.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-outputid="9d757e52-b073-4ae3-da18-9103b5e72162" data-execution_count="45">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>learn <span class="op">=</span> Learner(dls, nn_model, loss_func<span class="op">=</span>MSELossFlat())</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>learn.fit_one_cycle(<span class="dv">5</span>, <span class="fl">1e-2</span>, wd<span class="op">=</span><span class="fl">0.05</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>0.775485</td>
      <td>0.819169</td>
      <td>00:25</td>
    </tr>
    <tr>
      <td>1</td>
      <td>0.805927</td>
      <td>0.817436</td>
      <td>00:29</td>
    </tr>
    <tr>
      <td>2</td>
      <td>0.777418</td>
      <td>0.803896</td>
      <td>00:30</td>
    </tr>
    <tr>
      <td>3</td>
      <td>0.716998</td>
      <td>0.798450</td>
      <td>00:26</td>
    </tr>
    <tr>
      <td>4</td>
      <td>0.652017</td>
      <td>0.812329</td>
      <td>00:25</td>
    </tr>
  </tbody>
</table>
</div>
</div>
<p>We get roughly the same final MSE.</p>
</section>
</section>
<section id="use-full-dataset" class="level1">
<h1>Use Full DataSet</h1>
<p>Since we are done prototyping and experimenting with the small dataset, it is time to use the full dataset for modelling.</p>
<p>Our full dataset has around 6 million ratings, instead of the 100k we worked with earlier. Therefore it will probably take longer to train. Due to that, we need to train the model for a short number of epochs then save the model’s current progress before we continue training.</p>
<p>We will load in the ratings and pre-process the DataSet as before, then create a DataLoaders object and train the model:</p>
<div class="cell" data-outputid="c7358b71-2eb1-4016-d806-996db251c0ba" data-execution_count="44">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>ratings <span class="op">=</span> pd.read_csv(path<span class="op">/</span><span class="st">'ratings.csv'</span>)</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>ratings.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="44">
<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>user_id</th>
      <th>book_id</th>
      <th>rating</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>258</td>
      <td>5</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>4081</td>
      <td>4</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>260</td>
      <td>5</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2</td>
      <td>9296</td>
      <td>5</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2</td>
      <td>2318</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-outputid="0880987e-0d71-4f7b-c8a1-01482984435d" data-execution_count="45">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>ratings <span class="op">=</span> ratings.merge(books)</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>ratings.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="45">
<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>user_id</th>
      <th>book_id</th>
      <th>rating</th>
      <th>goodreads_book_id</th>
      <th>authors</th>
      <th>original_publication_year</th>
      <th>original_title</th>
      <th>average_rating</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>258</td>
      <td>5</td>
      <td>1232</td>
      <td>Carlos Ruiz Zafón, Lucia Graves</td>
      <td>2001.0</td>
      <td>La sombra del viento</td>
      <td>4.24</td>
    </tr>
    <tr>
      <th>1</th>
      <td>11</td>
      <td>258</td>
      <td>3</td>
      <td>1232</td>
      <td>Carlos Ruiz Zafón, Lucia Graves</td>
      <td>2001.0</td>
      <td>La sombra del viento</td>
      <td>4.24</td>
    </tr>
    <tr>
      <th>2</th>
      <td>143</td>
      <td>258</td>
      <td>4</td>
      <td>1232</td>
      <td>Carlos Ruiz Zafón, Lucia Graves</td>
      <td>2001.0</td>
      <td>La sombra del viento</td>
      <td>4.24</td>
    </tr>
    <tr>
      <th>3</th>
      <td>242</td>
      <td>258</td>
      <td>5</td>
      <td>1232</td>
      <td>Carlos Ruiz Zafón, Lucia Graves</td>
      <td>2001.0</td>
      <td>La sombra del viento</td>
      <td>4.24</td>
    </tr>
    <tr>
      <th>4</th>
      <td>325</td>
      <td>258</td>
      <td>4</td>
      <td>1232</td>
      <td>Carlos Ruiz Zafón, Lucia Graves</td>
      <td>2001.0</td>
      <td>La sombra del viento</td>
      <td>4.24</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="46">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>dls <span class="op">=</span> CollabDataLoaders.from_df(ratings<span class="op">=</span>ratings, valid_pct<span class="op">=</span><span class="fl">0.2</span>, </span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>                                user_name<span class="op">=</span><span class="st">'user_id'</span>, item_name<span class="op">=</span><span class="st">'original_title'</span>,</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>                                rating_name<span class="op">=</span><span class="st">'rating'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-outputid="49eca74f-e86b-44f0-9c3c-a70ed97a7313" data-execution_count="47">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>dls.show_batch()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>user_id</th>
      <th>original_title</th>
      <th>rating</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>14055</td>
      <td>The Crying of Lot 49</td>
      <td>3</td>
    </tr>
    <tr>
      <th>1</th>
      <td>52968</td>
      <td>The Gunslinger</td>
      <td>5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>14644</td>
      <td>The Five People You Meet in Heaven</td>
      <td>4</td>
    </tr>
    <tr>
      <th>3</th>
      <td>5431</td>
      <td>The Gods Themselves</td>
      <td>5</td>
    </tr>
    <tr>
      <th>4</th>
      <td>31889</td>
      <td>A Wrinkle in Time</td>
      <td>5</td>
    </tr>
    <tr>
      <th>5</th>
      <td>27179</td>
      <td>Jurassic Park</td>
      <td>5</td>
    </tr>
    <tr>
      <th>6</th>
      <td>46433</td>
      <td>Watchmen</td>
      <td>5</td>
    </tr>
    <tr>
      <th>7</th>
      <td>43269</td>
      <td>The Fault in Our Stars</td>
      <td>1</td>
    </tr>
    <tr>
      <th>8</th>
      <td>39282</td>
      <td>A Return to Love: Reflections on the Principles of "A Course in Miracles"</td>
      <td>5</td>
    </tr>
    <tr>
      <th>9</th>
      <td>11652</td>
      <td>The Mist</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div>
</div>
<div class="cell" data-execution_count="48">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>n_users <span class="op">=</span> <span class="bu">len</span>(dls.classes[<span class="st">'user_id'</span>])</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>n_books <span class="op">=</span> <span class="bu">len</span>(dls.classes[<span class="st">'original_title'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-outputid="645c96e4-a4a8-4671-e3e7-f52e0d54575f" data-execution_count="51">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>doc(collab_learner)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<h4 id="collab_learner" class="doc_header anchored" data-anchor-id="use-full-dataset"><code>collab_learner</code><a href="https://github.com/fastai/fastai/tree/master/fastai/collab.py#L90" class="source_link" style="float:right">[source]</a></h4><blockquote class="blockquote"><p><code>collab_learner</code>(<strong><code>dls</code></strong>, <strong><code>n_factors</code></strong>=<em><code>50</code></em>, <strong><code>use_nn</code></strong>=<em><code>False</code></em>, <strong><code>emb_szs</code></strong>=<em><code>None</code></em>, <strong><code>layers</code></strong>=<em><code>None</code></em>, <strong><code>config</code></strong>=<em><code>None</code></em>, <strong><code>y_range</code></strong>=<em><code>None</code></em>, <strong><code>loss_func</code></strong>=<em><code>None</code></em>, <strong><code>opt_func</code></strong>=<em><code>Adam</code></em>, <strong><code>lr</code></strong>=<em><code>0.001</code></em>, <strong><code>splitter</code></strong>=<em><code>trainable_params</code></em>, <strong><code>cbs</code></strong>=<em><code>None</code></em>, <strong><code>metrics</code></strong>=<em><code>None</code></em>, <strong><code>path</code></strong>=<em><code>None</code></em>, <strong><code>model_dir</code></strong>=<em><code>'models'</code></em>, <strong><code>wd</code></strong>=<em><code>None</code></em>, <strong><code>wd_bn_bias</code></strong>=<em><code>False</code></em>, <strong><code>train_bn</code></strong>=<em><code>True</code></em>, <strong><code>moms</code></strong>=<em><code>(0.95, 0.85, 0.95)</code></em>)</p>
</blockquote>
<p>Create a Learner for collaborative filtering on <code>dls</code>.</p>
<p><a href="https://docs.fast.ai/collab#collab_learner" target="_blank" rel="noreferrer noopener">Show in docs</a></p>
</div>
</div>
<p>We will use the collab_learner provided by fastai for convinience purposes and since I want to export my model after and create an inference app after.</p>
<p><strong>Note</strong>: It does the exact same thing as our DotProduct Model but has some nice additions on top.</p>
<div class="cell" data-execution_count="52">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>learn <span class="op">=</span> collab_learner(dls, n_factors<span class="op">=</span><span class="dv">500</span>, y_range<span class="op">=</span>(<span class="dv">0</span>, <span class="fl">5.5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-outputid="f4f10202-d22c-493e-98ab-c870924c0ff3" data-execution_count="53">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>learn.lr_find()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display" data-execution_count="53">
<pre><code>SuggestedLRs(lr_min=0.19054607152938843, lr_steep=2.511886486900039e-05)</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="similar-books_files/figure-html/cell-53-output-3.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-outputid="cc8bc166-34da-49cd-983b-7fc166628515" data-execution_count="54">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>learn.fit_one_cycle(<span class="dv">4</span>, <span class="fl">1e-1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>7.333699</td>
      <td>7.176844</td>
      <td>24:07</td>
    </tr>
    <tr>
      <td>1</td>
      <td>7.123693</td>
      <td>6.995453</td>
      <td>24:09</td>
    </tr>
    <tr>
      <td>2</td>
      <td>5.130961</td>
      <td>5.162658</td>
      <td>23:57</td>
    </tr>
    <tr>
      <td>3</td>
      <td>1.104243</td>
      <td>1.095618</td>
      <td>24:06</td>
    </tr>
  </tbody>
</table>
</div>
</div>
<p>After 4 epochs, we get a MSE of 1.09. This is probably a good time to save the model so we do not lose our progress:</p>
<div class="cell" data-outputid="41b6d119-bdcf-4ac0-c8e4-3540acb914f5" data-execution_count="55">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>learn.save(<span class="st">'4epochs'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="55">
<pre><code>Path('models/4epochs.pth')</code></pre>
</div>
</div>
<p>We can now load up the model and find continue training it for two more epochs and see if it improves:</p>
<div class="cell" data-execution_count="57">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>learn <span class="op">=</span> learn.load(<span class="st">'4epochs'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-outputid="efd47239-8f5a-455e-8631-d17b09ea1527" data-execution_count="58">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>learn.model</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="58">
<pre><code>EmbeddingDotBias(
  (u_weight): Embedding(53425, 500)
  (i_weight): Embedding(9269, 500)
  (u_bias): Embedding(53425, 1)
  (i_bias): Embedding(9269, 1)
)</code></pre>
</div>
</div>
<div class="cell" data-outputid="1f825f9b-49b1-4fbf-bd60-e9b5e331f8d1" data-execution_count="59">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>learn.lr_find()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display" data-execution_count="59">
<pre><code>SuggestedLRs(lr_min=0.002754228748381138, lr_steep=8.31763736641733e-06)</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="similar-books_files/figure-html/cell-59-output-3.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-outputid="85cdd055-7d83-4c8e-8358-41feacc2a197" data-execution_count="60">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>learn.fit_one_cycle(<span class="dv">2</span>, <span class="fl">1e-3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>0.631629</td>
      <td>0.749671</td>
      <td>24:14</td>
    </tr>
    <tr>
      <td>1</td>
      <td>0.374357</td>
      <td>0.715882</td>
      <td>24:15</td>
    </tr>
  </tbody>
</table>
</div>
</div>
<p>We go down to an MSE of 0.71 which is even better than what we got with the subset of the dataset.</p>
<p>Since it is taking long to train and I was happy with the results at this point, I stopped after 6 epochs and saved the model. However, if you have time and resources, you can continue training using the same process of saving progress after a few epochs.</p>
<div class="cell" data-outputid="ba57b654-2bde-4ac8-c62c-4a66d2e13193" data-execution_count="61">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>learn.save(<span class="st">'6epochs'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="61">
<pre><code>Path('models/6epochs.pth')</code></pre>
</div>
</div>
</section>
<section id="interpreting-the-full-model" class="level1">
<h1>Interpreting the Full Model</h1>
<p>We can see what our model with the full dataset learned.</p>
<p>We will start with the 5 books with the lowest bias (Generally bad books even if you would like the genre):</p>
<div class="cell" data-outputid="8a598505-b67f-46cd-a325-866aac96c88f" data-execution_count="63">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>book_bias <span class="op">=</span> learn.model.i_bias.weight.squeeze()</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>idxs <span class="op">=</span> book_bias.argsort()[:<span class="dv">5</span>]</span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>[dls.classes[<span class="st">'original_title'</span>][i] <span class="cf">for</span> i <span class="kw">in</span> idxs]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="63">
<pre><code>['One Night @ The Call Center',
 'Half Girlfriend',
 'ليتها تقرأ',
 'The 3 Mistakes of My Life',
 'of course i love you']</code></pre>
</div>
</div>
<p>The book <em>One Night @ The Call Center</em> makes another appearance. It must be a really bad book.</p>
<p>Now for the generally good books, the books with the highest book bias:</p>
<div class="cell" data-outputid="770662d2-ee12-4983-db87-5f3eba3f0425" data-execution_count="64">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>idxs <span class="op">=</span> book_bias.argsort(descending<span class="op">=</span><span class="va">True</span>)[:<span class="dv">5</span>]</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>[dls.classes[<span class="st">'original_title'</span>][i] <span class="cf">for</span> i <span class="kw">in</span> idxs]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="64">
<pre><code>['The Complete Calvin and Hobbes',
 'Words of Radiance',
 'Complete Harry Potter Boxed Set',
 'The Essential Calvin and Hobbes: A Calvin and Hobbes Treasury',
 'The Calvin and Hobbes Tenth Anniversary Book']</code></pre>
</div>
</div>
<p>Harry Potter makes another appearance. Let us check out one of the books:</p>
<div class="cell" data-outputid="1e3c1cb2-1503-4784-bce3-6666f9142e19" data-execution_count="65">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="bu">id</span> <span class="op">=</span> <span class="bu">int</span>(books.loc[books[<span class="st">'original_title'</span>]<span class="op">==</span><span class="st">'Words of Radiance'</span>][<span class="st">'goodreads_book_id'</span>].values)</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>url <span class="op">=</span> <span class="ss">f'https://www.goodreads.com/book/show/</span><span class="sc">{</span><span class="bu">id</span><span class="sc">}</span><span class="ss">'</span></span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>url</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="65">
<pre><code>'https://www.goodreads.com/book/show/17332218'</code></pre>
</div>
</div>
<p>Here is a sample review of the book:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="data:image/png;base64,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++03Fi1aJPMOHkV8aIOD4uJivL29deGQ3r17YzAYWLduHWVlZZw4cYKlS5c6PObDig9o8FZERkbSu3dvjh075vAcrelLm+uroSExfvr06fKY48aNo0uXLkDDzC4hBK+++iq//vorly9fJicnRwr/BxUftgOtJUuW4Onpqeubk5OTCQ0NpbCwkLy8PG7fvm23jVqybw8jPlpzXGid3XRkPx5GfCxdupTk5GTZxhs3bpQzgZ4lpPi4efMmaWlp+Pr6EhkZydChQ6WxuHLliuycPTw8iI+Pt7tQSllZmXTNBwQEkJiYqEtMLC4upmfPnnLK4fDhw2XG9YYNGwgODsZisZCWlsasWbMwGAxMnjwZaIjd9uvXD5PJhNVqZdOmTZjNZkJCQigpKSErKwtfX1+cnJxISUmhqqqKUaNG4ezsjKenp0x6evXVVxFC4OPjw/LlywFYuXKlTNC0/fTp08euYLB3roqKChITEzEajSQkJMhsb4BZs2bRsWPHVi/FrBk12wdWSzRzpGA3btxIVFQUBoOB8PBwJk6cKF8AW4MtRENCo9ax37t3j2nTpuHn54e3tzdTpkxh6NChuLi4EBcXBzRM20pKSsLX1xeLxUJCQkKzy24fP36cnj174urqip+fH6+99prspA8ePNiknbVZDrasXLlSelg0AXLx4kUqKyvl9LV27dpx6tQpRo0ahbu7O8HBwSxfvpygoCBcXV0ZPXo00CB2kpKScHNzIzExUf6/PT092bhxI6+88oruenbt2sXFixflPcTGxrJixQoMBgNms5nVq1fLKdDaZ8+ePQwfPly37fz581RXVzNz5kz8/PwwGAzExsbKZEFoyFd58cUXcXV1lVNtjx49arddx4wZI59nzchp6560b9+enJwcLly4IPN9IiMjuXDhAn369MFgMODp6SlzcYqKinB1dZWeGe0TGhrKhQsXmDt3rpylpL2DGRkZuLi44O7uLnNMCgoKCAoKwmQy0a9fP12eiS1Tp07FbDbTsWNHsrKyGDx4MD4+PmzYsIHr168zbNgwIiMj6d69O4mJic16PaAhbOTm5qYTQlp4ctSoUbp96+rqWLhwIQEBARgMBjp37szy5cupr69n0qRJeHp64uTkRJcuXeR77OLigoeHh26UbcuhQ4dITEwkNDSUxMRE4uPjmyzyVF5ezsiRI/H09MTNzY1evXrp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.png" class="img-fluid figure-img"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Screenshot_2021-02-15 Words of Radiance (The Stormlight Archive, #2).png</figcaption><p></p>
</figure>
</div>
<p>Next we can check out the Book Embeddings using the PCA trick we utilized before:</p>
<div class="cell" data-outputid="62c59cce-502d-4064-c0c8-bd0ca6460da6" data-execution_count="67">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>learn.model</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="67">
<pre><code>EmbeddingDotBias(
  (u_weight): Embedding(53425, 500)
  (i_weight): Embedding(9269, 500)
  (u_bias): Embedding(53425, 1)
  (i_bias): Embedding(9269, 1)
)</code></pre>
</div>
</div>
<div class="cell" data-outputid="c2a2f12e-d012-4fc3-9ce0-e41edb17cc76" data-execution_count="71">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>g <span class="op">=</span> ratings.groupby(<span class="st">'original_title'</span>)[<span class="st">'rating'</span>].count()</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>top_books <span class="op">=</span> g.sort_values(ascending<span class="op">=</span><span class="va">False</span>).index.values[:<span class="dv">10000</span>]</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>top_idxs <span class="op">=</span> tensor([learn.dls.classes[<span class="st">'original_title'</span>].o2i[m] <span class="cf">for</span> m <span class="kw">in</span> top_books])</span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>books_w <span class="op">=</span> learn.model.i_weight.weight[top_idxs].cpu().detach()</span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>books_pca <span class="op">=</span> books_w.pca(<span class="dv">3</span>)</span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>fac0,fac1,fac2 <span class="op">=</span> books_pca.t()</span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a>idxs <span class="op">=</span> <span class="bu">list</span>(<span class="bu">range</span>(<span class="dv">50</span>))</span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> fac0[idxs]</span>
<span id="cb89-9"><a href="#cb89-9" aria-hidden="true" tabindex="-1"></a>Y <span class="op">=</span> fac2[idxs]</span>
<span id="cb89-10"><a href="#cb89-10" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>,<span class="dv">12</span>))</span>
<span id="cb89-11"><a href="#cb89-11" aria-hidden="true" tabindex="-1"></a>plt.scatter(X, Y)</span>
<span id="cb89-12"><a href="#cb89-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, x, y <span class="kw">in</span> <span class="bu">zip</span>(top_books[idxs], X, Y):</span>
<span id="cb89-13"><a href="#cb89-13" aria-hidden="true" tabindex="-1"></a>    plt.text(x,y,i, color<span class="op">=</span>np.random.rand(<span class="dv">3</span>)<span class="op">*</span><span class="fl">0.7</span>, fontsize<span class="op">=</span><span class="dv">11</span>)</span>
<span id="cb89-14"><a href="#cb89-14" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="similar-books_files/figure-html/cell-67-output-1.png" class="img-fluid figure-img"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Representation of Books based on two strongest PCA components</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>And we can check the distances (similar books). We use The Da Vinci Code again as an example:</p>
<div class="cell" data-outputid="f4b07c68-561a-4ba5-f4c7-de59e582c775" data-execution_count="73">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>book_factors <span class="op">=</span> learn.model.i_weight.weight</span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>idx <span class="op">=</span> dls.classes[<span class="st">'original_title'</span>].o2i[<span class="st">'The Da Vinci Code'</span>]</span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>distances <span class="op">=</span> nn.CosineSimilarity(dim<span class="op">=</span><span class="dv">1</span>)(book_factors, book_factors[idx][<span class="va">None</span>])</span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>idx <span class="op">=</span> distances.argsort(descending<span class="op">=</span><span class="va">True</span>)[<span class="dv">1</span>:<span class="dv">6</span>]</span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a><span class="co"># dls.classes['original_title'][idx]</span></span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a>[dls.classes[<span class="st">'original_title'</span>][i] <span class="cf">for</span> i <span class="kw">in</span> idx]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="73">
<pre><code>['Angels &amp; Demons ',
 'The Lost Symbol',
 'Deception Point',
 'Digital Fortress',
 'The Firm']</code></pre>
</div>
</div>
<p>Now that I am happy with my model, I will export it and use it to create a Web App for Recommending Similar Books. That will be in Part 2 of this blog and it is coming soon.</p>
<div class="cell" data-execution_count="74">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>learn.export(<span class="st">'final_model.pkl'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>


</section>

</main> <!-- /main -->
<script type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
    } else {
      disableStylesheet(alternateStylesheets);
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } 
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">Copyright 2022, Jimmie Munyi</div>   
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/jimmiemunyi">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/jimmie_munyi">
      <i class="bi bi-twitter" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>



</body></html>